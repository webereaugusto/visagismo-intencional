---
const whatsappLink = "https://wa.me/5519991103018?text=Olá, gostaria de agendar uma consultoria exclusiva";
const whatsappLinkEndereco = "https://wa.me/5519991103018?text=Olá, gostaria de conhecer o novo espaço no Cambuí";

const slides = [
  {
    image: "/images/baner.webp",
    label: "Cambuí • Campinas",
    title1: "Visagismo",
    title2: "Intencional",
    subtitle: 'Visagismo em Campinas é no novíssimo <strong class="text-gold">Visagismo Intencional</strong> do Ery Junior. No coração pulsante do Cambuí, onde ciência e arte se encontram para revelar sua melhor versão.',
    cta1Text: "Agende sua Consultoria",
    cta1Link: whatsappLink,
    cta2Text: "Saiba Mais",
    cta2Link: "#visagismo"
  },
  {
    image: "/images/ery-junior-hero.webp",
    label: "Novidade 2026",
    title1: "Novo",
    title2: "Endereço",
    subtitle: 'Agora em um espaço ainda mais exclusivo no <strong class="text-gold">coração do Cambuí</strong>. Rua Cel. Quirino, 41 — o endereço mais sofisticado de Campinas para sua transformação.',
    cta1Text: "Conheça o Espaço",
    cta1Link: whatsappLinkEndereco,
    cta2Text: "Ver Localização",
    cta2Link: "#localizacao"
  }
];
---

<section class="relative min-h-screen flex items-end md:items-center overflow-hidden bg-dark" id="hero">
  
  <!-- Slides Container -->
  <div class="absolute inset-0 z-0">
    {slides.map((slide, index) => (
      <div 
        class={`hero-slide absolute inset-0 transition-opacity duration-1000 ${index === 0 ? 'opacity-100' : 'opacity-0'}`}
        data-slide={index}
      >
        <!-- Background Image -->
        <div class="absolute inset-0 overflow-hidden">
          <div class="absolute inset-0 w-full h-full md:h-[130%] md:-top-[15%] will-change-transform hero-parallax-bg">
            <img 
              src={slide.image} 
              alt={`${slide.title1} ${slide.title2} - Ery Junior`}
              class="w-full h-full object-cover object-[85%_top] md:object-center opacity-80 md:opacity-70"
              fetchpriority={index === 0 ? "high" : "low"}
              decoding={index === 0 ? "sync" : "async"}
              loading={index === 0 ? "eager" : "lazy"}
              width="1920"
              height="1080"
            />
          </div>
          <!-- Gradient Overlay -->
          <div class="absolute inset-0 bg-gradient-to-t from-dark via-dark/80 to-dark/30 md:bg-gradient-to-r md:from-dark/80 md:via-dark/50 md:to-transparent"></div>
        </div>
      </div>
    ))}
  </div>
  
  <!-- Elegant Corner Frame -->
  <div class="absolute inset-2 sm:inset-3 md:inset-4 lg:inset-6 z-20 pointer-events-none">
    <!-- Top Left Corner -->
    <div class="absolute top-0 left-0 w-10 sm:w-16 md:w-24 lg:w-32 h-10 sm:h-16 md:h-24 lg:h-32">
      <div class="absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-gold/60 md:from-gold/80 to-transparent"></div>
      <div class="absolute top-0 left-0 h-full w-[1px] bg-gradient-to-b from-gold/60 md:from-gold/80 to-transparent"></div>
    </div>
    
    <!-- Top Right Corner -->
    <div class="absolute top-0 right-0 w-10 sm:w-16 md:w-24 lg:w-32 h-10 sm:h-16 md:h-24 lg:h-32">
      <div class="absolute top-0 right-0 w-full h-[1px] bg-gradient-to-l from-gold/60 md:from-gold/80 to-transparent"></div>
      <div class="absolute top-0 right-0 h-full w-[1px] bg-gradient-to-b from-gold/60 md:from-gold/80 to-transparent"></div>
    </div>
    
    <!-- Bottom Left Corner -->
    <div class="absolute bottom-0 left-0 w-10 sm:w-16 md:w-24 lg:w-32 h-10 sm:h-16 md:h-24 lg:h-32">
      <div class="absolute bottom-0 left-0 w-full h-[1px] bg-gradient-to-r from-gold/60 md:from-gold/80 to-transparent"></div>
      <div class="absolute bottom-0 left-0 h-full w-[1px] bg-gradient-to-t from-gold/60 md:from-gold/80 to-transparent"></div>
    </div>
    
    <!-- Bottom Right Corner -->
    <div class="absolute bottom-0 right-0 w-10 sm:w-16 md:w-24 lg:w-32 h-10 sm:h-16 md:h-24 lg:h-32">
      <div class="absolute bottom-0 right-0 w-full h-[1px] bg-gradient-to-l from-gold/60 md:from-gold/80 to-transparent"></div>
      <div class="absolute bottom-0 right-0 h-full w-[1px] bg-gradient-to-t from-gold/60 md:from-gold/80 to-transparent"></div>
    </div>
  </div>
  
  <!-- Content Slides -->
  <div class="relative z-10 max-w-7xl mx-auto px-5 md:px-6 pb-24 pt-32 md:py-32 w-full">
    {slides.map((slide, index) => (
      <div 
        class={`hero-content max-w-3xl transition-all duration-700 ${index === 0 ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-8 absolute inset-0 pointer-events-none'}`}
        data-content={index}
      >
        <!-- Label -->
        <div class="flex items-center gap-2 md:gap-3 mb-4 md:mb-8">
          <span class="w-8 md:w-12 h-[1px] bg-gold"></span>
          <span class="text-gold text-[10px] md:text-sm tracking-[0.2em] md:tracking-[0.3em] uppercase font-montserrat font-medium">
            {slide.label}
          </span>
        </div>
        
        <!-- Main Title -->
        <h1 class="font-playfair leading-[0.85] md:leading-[0.9] mb-6 md:mb-10">
          <span class="text-gradient-gold block text-[3.2rem] md:text-8xl lg:text-9xl xl:text-[10rem] font-medium tracking-tight">{slide.title1}</span>
          <span class="text-white block italic text-[2.5rem] md:text-7xl lg:text-8xl xl:text-9xl font-light -mt-1 md:-mt-2">{slide.title2}</span>
        </h1>
        
        <!-- Subtitle -->
        <p class="font-montserrat text-gray-light text-sm md:text-lg max-w-xl leading-relaxed mb-8 md:mb-12" set:html={slide.subtitle}></p>
        
        <!-- CTA Buttons -->
        <nav class="flex flex-col sm:flex-row gap-3 md:gap-4" aria-label="Ações principais">
          <a 
            href={slide.cta1Link}
            target="_blank"
            rel="noopener noreferrer"
            class="bg-gradient-to-r from-gold to-gold-dark text-dark px-6 md:px-10 py-4 md:py-5 text-xs md:text-sm font-semibold tracking-wider uppercase hover:shadow-lg hover:shadow-gold/30 transition-all duration-300 animate-shine text-center"
          >
            {slide.cta1Text}
          </a>
          
          <a 
            href={slide.cta2Link}
            class="border border-gold/50 text-white px-6 md:px-10 py-4 md:py-5 text-xs md:text-sm tracking-wider uppercase hover:bg-gold/10 hover:border-gold transition-all duration-300 text-center"
          >
            {slide.cta2Text}
          </a>
        </nav>
      </div>
    ))}
  </div>
  
  <!-- Slider Navigation -->
  <div class="absolute bottom-24 md:bottom-10 left-1/2 -translate-x-1/2 z-30 flex items-center gap-4">
    <button id="hero-prev" class="w-10 h-10 flex items-center justify-center border border-gold/50 text-gold hover:bg-gold hover:text-dark transition-all" aria-label="Slide anterior">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
    </button>
    
    <div class="flex gap-3">
      {slides.map((_, index) => (
        <button 
          class={`hero-dot w-3 h-3 rounded-full transition-all ${index === 0 ? 'bg-gold scale-100' : 'bg-gold/40 scale-75'}`}
          data-index={index}
          aria-label={`Ir para slide ${index + 1}`}
        ></button>
      ))}
    </div>
    
    <button id="hero-next" class="w-10 h-10 flex items-center justify-center border border-gold/50 text-gold hover:bg-gold hover:text-dark transition-all" aria-label="Próximo slide">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </button>
  </div>
  
  <!-- Scroll Indicator - Hidden on small mobile -->
  <div class="absolute bottom-6 md:bottom-10 right-6 md:right-10 z-10 hidden sm:block">
    <a href="#essencia" aria-label="Rolar para próxima seção" class="block">
      <div class="w-9 md:w-10 h-9 md:h-10 rounded-full border border-gold/50 flex items-center justify-center hover:border-gold hover:bg-gold/10 transition-all" role="presentation">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 md:h-4 w-3.5 md:w-4 text-gold animate-bounce" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
        </svg>
      </div>
    </a>
  </div>
</section>

<style>
  @media (prefers-reduced-motion: reduce) {
    .hero-slide,
    .hero-content {
      transition: none;
    }
  }
</style>

<script>
  // Hero Slider
  const heroSlides = document.querySelectorAll('.hero-slide');
  const heroContents = document.querySelectorAll('.hero-content');
  const heroDots = document.querySelectorAll('.hero-dot');
  const heroPrev = document.getElementById('hero-prev');
  const heroNext = document.getElementById('hero-next');
  
  let heroCurrentSlide = 0;
  const totalSlides = heroSlides.length;
  let heroAutoPlayInterval: ReturnType<typeof setInterval>;
  
  function showHeroSlide(index: number) {
    // Handle index bounds
    if (index < 0) index = totalSlides - 1;
    if (index >= totalSlides) index = 0;
    
    // Update slides
    heroSlides.forEach((slide, i) => {
      if (i === index) {
        slide.classList.remove('opacity-0');
        slide.classList.add('opacity-100');
      } else {
        slide.classList.remove('opacity-100');
        slide.classList.add('opacity-0');
      }
    });
    
    // Update content
    heroContents.forEach((content, i) => {
      if (i === index) {
        content.classList.remove('opacity-0', 'translate-y-8', 'pointer-events-none');
        content.classList.add('opacity-100', 'translate-y-0');
      } else {
        content.classList.remove('opacity-100', 'translate-y-0');
        content.classList.add('opacity-0', 'translate-y-8', 'pointer-events-none');
      }
    });
    
    // Update dots
    heroDots.forEach((dot, i) => {
      if (i === index) {
        dot.classList.remove('bg-gold/40', 'scale-75');
        dot.classList.add('bg-gold', 'scale-100');
      } else {
        dot.classList.remove('bg-gold', 'scale-100');
        dot.classList.add('bg-gold/40', 'scale-75');
      }
    });
    
    heroCurrentSlide = index;
  }
  
  function nextHeroSlide() {
    showHeroSlide(heroCurrentSlide + 1);
  }
  
  function prevHeroSlide() {
    showHeroSlide(heroCurrentSlide - 1);
  }
  
  function startAutoPlay() {
    heroAutoPlayInterval = setInterval(nextHeroSlide, 6000);
  }
  
  function resetAutoPlay() {
    clearInterval(heroAutoPlayInterval);
    startAutoPlay();
  }
  
  // Event listeners
  heroPrev?.addEventListener('click', () => {
    prevHeroSlide();
    resetAutoPlay();
  });
  
  heroNext?.addEventListener('click', () => {
    nextHeroSlide();
    resetAutoPlay();
  });
  
  heroDots.forEach((dot, index) => {
    dot.addEventListener('click', () => {
      showHeroSlide(index);
      resetAutoPlay();
    });
  });
  
  // Start auto-play
  startAutoPlay();
  
  // Parallax effect - Desktop only
  const parallaxBgs = document.querySelectorAll('.hero-parallax-bg');
  const heroSection = document.getElementById('hero');
  
  if (parallaxBgs.length > 0 && heroSection) {
    const isMobile = () => window.innerWidth < 768;
    
    let ticking = false;
    
    const updateParallax = () => {
      if (isMobile()) {
        parallaxBgs.forEach(bg => {
          (bg as HTMLElement).style.transform = 'none';
        });
        return;
      }
      
      const scrolled = window.pageYOffset;
      const heroHeight = heroSection.offsetHeight;
      
      if (scrolled < heroHeight) {
        const speed = 0.4;
        parallaxBgs.forEach(bg => {
          (bg as HTMLElement).style.transform = `translateY(${scrolled * speed}px)`;
        });
      }
      ticking = false;
    };
    
    window.addEventListener('scroll', () => {
      if (!ticking) {
        requestAnimationFrame(updateParallax);
        ticking = true;
      }
    }, { passive: true });
    
    window.addEventListener('resize', () => {
      if (isMobile()) {
        parallaxBgs.forEach(bg => {
          (bg as HTMLElement).style.transform = 'none';
        });
      }
    }, { passive: true });
  }
</script>
